# HTTP幂等性
#### 概念
HTTP方法的幂等性是指一次和多次请求某一个资源应该具有同样的副作用，幂等性是分布式系统设计中十分重要的概念，而HTTP的分布式本质也决定了它在HTTP中具有重要地位。
* 一次请求的影响和多次请求的影响一样
#### 举例
1. 用户买东西扣钱，发出支付请求，客户端收到并且扣除成功，但因为网路问题，返回支付成功信息失败<br>
2. 用户不确定是否扣款成功，用发起的支付请求，服务端收到又扣了一次钱<br>
#### 解决方法
1. 采用分布式式事务，添加一个中间件处理扣款功能，但架构太重量级，容易被绑定在特定的中间件上，不利于异构系统集成。虽然能保证事务的ACID性质，但无法提供性能和可用性保证<br>
2. 幂等设计<br>
请求支付前获取一个支付id，获取失败的话下次请求还是获取id，直到获取成功，如果请求时客户端有支付id就进入扣款逻辑，且这个id只能操作处理一次。如果扣款成功但为正确返回，用户在次请求。判断了id已经处理了，则继续正确返回。<br>
<img src="https://images.cnblogs.com/cnblogs_com/weidagang2046/201106/201106042051069339.png" />

#### rest下
get,delete,put幂等
post不幂等